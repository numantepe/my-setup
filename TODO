function! YankFunction() abort
  let l:text = getreg('z')
  let l:command = 'echo ' . shellescape(l:text) . ' | yank'
  " Write the output to a file
  let l:output_file = expand('~/yank_output.log')
  call writefile([system(l:command)], l:output_file, 'a')

  " Use cat to display the output in the terminal (forces terminal handling)
  call system('cat ' . l:output_file)
endfunction

nnoremap <silent> <leader>y "zyy:call YankFunction()<CR>
vnoremap <silent> <leader>y "zy:call YankFunction()<CR>





function! YankFunction() abort
  let l:text = getreg('z')
  let l:command = 'echo ' . shellescape(l:text) . ' | yank'
  " Open a new terminal window to run the yank command and close it automatically
  call system('xterm -hold -e "sh -c ' . shellescape(l:command) . '" &')
endfunction

nnoremap <silent> <leader>y "zyy:call YankFunction()<CR>
vnoremap <silent> <leader>y "zy:call YankFunction()<CR>
